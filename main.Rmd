---
title: "main.r"
author: "JohnHadish"
date: "3/8/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Testing The Program:
Each Function should have its own demonstration script: 

Download Data:
```{r}
myGenotype=read.table(file="http://zzlab.net/GAPIT/data/mdp_numeric.txt",head=T)
myPosition=read.table(file="http://zzlab.net/GAPIT/data/mdp_SNP_information.txt",head=T)
myPhenotype=read.table(file="http://zzlab.net/GAPIT/data/CROP545_Phenotype.txt",head=T)
myCovariate=read.table(file="http://zzlab.net/GAPIT/data/CROP545_Covariates.txt",head=T)
```



Description: 
returns: P: a vector n long of p values for every gene in n
Dependent: Generate_PCA, Scree, Determine_Linear_Dependent
```{r, Run_GLM}
Run_GLM(X, y, C)
```

returns: principal components after scree analysis
```{r, Determine_PC_Number}
library(plotly)
library(ggplot2)
library(gridExtra)
library(knitr)

allPC=prcomp(myGenotype[,-1])



threshPC <- pcThreshold(allPC)




a<-pcCoVariance(PC, myCovariate, .7)





graphPCA <- function(myGenotype, PC)
{
  # Plotting var_exp_plot
  var_exp_plot_data <- data.frame(t(summary$importance))
  names(var_exp_plot_data) <- c("sdev", "var_exp", "cum_var_exp") 
  var_exp_plot_data$pca_index <- 1:nrow(var_exp_plot_data) 
  var_exp_plot <- ggplot(data = var_exp_plot_data, aes(x = pca_index, y = var_exp)) +
    geom_line() +
    geom_point() +
    labs(x = "PCA component index", y = "Variance explained", title = "GAPIT Demo GT: Variance Explained")
  var_exp_plot
  
  
  
}
# Table just creates a table of 8
kable(round(summary$importance[,1:8], 2))

# Scree Plot
screeplot(pca1, npcs = 8, type = "lines")



# Plotting cumulative variance
cum_var_exp_plot <- ggplot(data = var_exp_plot_data, aes(x = pca_index, y = cum_var_exp)) +
  geom_line() +
  geom_point() +
  labs(x = "PCA component index", y = "Cumulative Variance explained", title = "GAPIT Demo GT: Cumulative Variance Explained")
cum_var_exp_plot
pca_comp_plot_data <- data.frame(princomp)

# Plotting the first two components
pca_comp_plot_12 <- 
  ggplot(data = pca_comp_plot_data, aes(x = PC1, y = PC2)) +
  geom_point()

pca_comp_plot_13 <-
  ggplot(data = pca_comp_plot_data, aes(x = PC1, y = PC3)) +
  geom_point()

pca_comp_plot_23 <-
  ggplot(data = pca_comp_plot_data, aes(x = PC2, y = PC3)) +
  geom_point()

# 3D plot
grid.arrange(pca_comp_plot_12, pca_comp_plot_13, pca_comp_plot_23, nrow = 2, ncol = 2, top = "GAPIT Demo GT: Principal Components")
fig <- plot_ly(data = pca_comp_plot_data, x = ~PC1, y = ~PC2, z = ~PC3)
fig <- fig %>% add_markers()
fig <- fig %>% layout(scene = list(xaxis = list(title = 'PC1'),
                     yaxis = list(title = 'PC2'),
                     zaxis = list(title = 'PC3')))

htmlwidgets::saveWidget(as_widget(fig), "PCA_3d.html")



# prints a table of the first 8
kable(round(summary$importance[,1:pcano], 2))


}


```


returns: unknown
```{r, Determine_linear_dependent}

Determine_Linear_Dependent(PC, C)
```



Returns: a QQ plot of observed and expected p values
```{r, Plot_QQ}
Plot_QQ(P)
```

Returnes: Manhatten plot
```{r, Plot_ Manhatten}
Plot_Manhatten(I, P)
```

P_Threshold
returns: how many true positives are above the first false positive
```{r}
```





